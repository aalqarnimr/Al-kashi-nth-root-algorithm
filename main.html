<!DOCTYPE html>
<html lang="en" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      body {
        margin: 0;
      }
      h1 {
        margin: 0px;
      }
      input#root-power {
        margin-right: 10px;
      }
      form {
        margin: 20px;
      }
      table {
        border: 1px solid black;
      }
      th {
        padding: 15px;
      }

      .end {
        grid-area: footer;
      }
      form button[type="button"] {
        margin-right: 15px;
        font-size: 20px;
        padding: 0 15px;
      }
      header {
        background-color: rosybrown;
        padding-right: 15px;
        padding: 25px;
        margin: 0;
      }
      .table_container {
        display: flex;
        align-items: center;
        flex-direction: column;
        flex: 1 1 0px;
      }
      tr,
      thead,
      th {
        border: 1px solid black;
      }
      .root-result {
        direction: ltr;
        padding-left: 20px;
        margin-bottom: 10px;
      }
      table {
        border-top: none;
        border-left: none;
        border-right: none;
      }
      .resultRow th {
        border-top: none;
        border-bottom: none;
      }
      .resultRow th:first-of-type {
        border-right: none;
      }
      .resultRow th:last-of-type {
        border-left: none;
      }
    </style>
  </head>
  <body>
    <header><h1>خوارزمية ايجاد الجذر النوني للكاشي</h1></header>
    <form>
      <p>
        <label for="whole">الرقم المجذور: </label>
        <input type="number" id="whole" />
      </p>
      <p>
        <label for="root-power">درجة الجذر: </label>
        <input type="number" id="root-power" />
      </p>
      <p>
        <button type="button" onclick="startAlgorithm()">أبدا</button>
      </p>
    </form>
    <hr />
    <div class="table_container">
      <div class="root-result">
        <span>first</span>
      </div>
      <table>
        <thead>
          <tr class="resultRow"></tr>
          <tr class="headRow"></tr>
        </thead>
      </table>
    </div>
    <script>
      const addCSS = (css) =>
        (document.head.appendChild(document.createElement("style")).innerHTML =
          css);
      function startAlgorithm() {
        resetTable();
        var whole = document.getElementById("whole").value;
        var power = document.getElementById("root-power").valueAsNumber;
        tHeads = document.querySelectorAll("th");
        numbers = getDividedNumbers(whole);
        mergedNumbers = mergeNumbers(numbers, power);
        console.log(mergedNumbers);
        headRow = document.querySelector(".headRow");
        resultRow = document.querySelector(".resultRow");
        createRowCells(
          numbers,
          headRow,
          true,
          power - mergedNumbers[mergedNumbers.length - 1].toString().length
        );
        createRowCells([], resultRow, true, headRow.children.length, "");
        firstNumber = headRow.lastChild;
        resultNumbersElement = document.querySelector(".root-result");
        tableElement = document.querySelector("table");
        setWidth(resultNumbersElement, tableElement);
        removeBorder(headRow.children, power);

        console.log(firstNumber.innerHTML);
      }
      function getDividedNumbers(number) {
        var numbers = [];
        var i = 0;
        while (number != 0) {
          numbers[i] = number % 10;
          number = Math.floor(number / 10);
          i++;
        }
        return numbers;
      }
      function mergeNumbers(numbers, power) {
        var mergedNumbers = [];
        var index = 0;
        let lengthNumbers = numbers.length;
        while (index < lengthNumbers) {
          let number = 0;
          for (i = 0; i < power; i++) {
            if (index < lengthNumbers) {
              number += numbers[index] * Math.pow(10, i);
              index++;
            } else {
              number = number.toString();
            }
          }
          mergedNumbers.push(number);
        }
        return mergedNumbers;
      }
      function distributeNumbers(numbers, elements) {
        for ([index, element] of elements.entries()) {
          element.innerText = numbers[index];
        }
      }
      function leastNthRoot(number, power) {
        leastRoot = Math.floor(Math.pow(number, 1 / power));
        return leastRoot;
      }
      function* range(start, end) {
        for (let i = start; i < end; i++) {
          yield i;
        }
      }
      function createRowCells(
        numbersArr,
        row,
        isHead,
        extraCells = 0,
        extraCellsContent = 0
      ) {
        if (isHead) {
          element = "th";
        } else {
          element = "td";
        }
        console.log(extraCells);
        for (number of numbersArr) {
          tableCell = document.createElement(element);
          tableCell.appendChild(document.createTextNode(number));
          row.appendChild(tableCell);
        }
        for (i of range(0, extraCells)) {
          tableCell = document.createElement(element);
          tableCell.appendChild(document.createTextNode(extraCellsContent));
          row.appendChild(tableCell);
        }
      }
      function resetTable() {
        tableHeadRows = document.querySelectorAll("thead tr");
        for (row of tableHeadRows) {
          row.innerHTML = null;
        }
      }
      function setWidth(element, widthElement) {
        widthOfELement = widthElement.offsetWidth;
        element.style.width = widthOfELement + "px";
      }
      function printSpacing(number, width) {}
      function removeBorder(cells, multipier) {
        activeCellIndex = 1;
        cellsLength = cells.length;
        console.log(cells[0]);
        while (activeCellIndex < cellsLength) {
          for (i of range(1, multipier)) {
            cells[activeCellIndex - 1].style.borderLeft = "none";
            cells[activeCellIndex].style.borderRight = "none";
            activeCellIndex++;
          }
          activeCellIndex++;
        }
      }
      function mergeCells(cells, multipier) {
        activeCellIndex = 0;
        for (i of range(1, multipier)) {
          console.log(cells[activeCellIndex]);
          cells[activeCellIndex].css("border-left", "none");
          cells[activeCellIndex + 1].css("border-right", "none");
        }
      }
    </script>
  </body>
</html>
